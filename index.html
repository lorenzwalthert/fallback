<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="What the package does (one paragraph).">
<title>Default values for function calls from yaml config files • fallback</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Default values for function calls from yaml config files">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">fallback</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/development-paths.html">Development Paths</a>
    <a class="dropdown-item" href="articles/handover.html">handover</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lorenzwalthert/fallback/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<p><a href="https://travis-ci.org/lorenzwalthert/fallback" class="external-link"><img src="https://travis-ci.org/lorenzwalthert/fallback.svg?branch=master" alt="Travis build status"></a></p>
<p><a href="https://codecov.io/github/lorenzwalthert/fallback?branch=master" class="external-link"><img src="https://codecov.io/gh/lorenzwalthert/fallback/branch/master/graph/badge.svg" alt="Coverage status"></a></p>
<div class="section level1">
<div class="page-header"><h1 id="fallback">fallback<a class="anchor" aria-label="anchor" href="#fallback"></a>
</h1></div>
<p>The goal of fallback is to provide a mechanism for resolving the value of arguments of function calls at the time the function is called. It extends the concept of default values but the value resolution can also be used outside of this context.</p>
<p>See the below example for the primary use case:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="va">x</span></code></pre></div>
<p>If you call <code>g()</code> without arguments, the value of the argument <code>x</code> is determined as follows:</p>
<ol style="list-style-type: decimal">
<li><p>check if the function call specifies it.</p></li>
<li><p>if not, check if the function declaration specifies it.</p></li>
</ol>
<p>fallback provides a mechanism to extend this chain by defining more places to look for a specification. This can be helpful for functions that are called often interactively. For portability and transparency, the configuration could be stored in a config file. Below, we create a fallback chain that, when used in a function declaration</p>
<ol style="list-style-type: decimal">
<li><p>checks if the function call specifies the argument value.</p></li>
<li><p>If not, check if <code>fallbacks.yaml</code> in the working directory (<code>"."</code>) contains a key <code>"arg_1"</code>.</p></li>
<li><p>if not, checks if the home directory (<code>"~"</code>) contains such a file and key.</p></li>
<li><p>if not sets the argument to <code>TRUE</code>.</p></li>
</ol>
<!-- end list --><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lorenzwalthert/fallback" class="external-link">fallback</a></span><span class="op">)</span>
<span class="fu"><a href="reference/fallback.html">fallback</a></span><span class="op">(</span><span class="cn">TRUE</span>, source_file <span class="op">=</span> <span class="st">"fallbacks.yaml"</span>, hierarchy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"."</span>, <span class="st">"~"</span><span class="op">)</span>, key <span class="op">=</span> <span class="st">"arg_1"</span><span class="op">)</span>
<span class="co">#&gt; &lt;fallback&gt;</span>
<span class="co">#&gt; key                     "arg_1" ... </span>
<span class="co">#&gt; value                   </span>
<span class="co">#&gt; hierarchy               . -&gt; ~</span>
<span class="co">#&gt; terminal fallback value TRUE ... </span>
<span class="co">#&gt; source file             fallbacks.yaml</span></code></pre></div>
<p>The above values apart from <code>key</code> are defaults, so we can omit them. <code>key</code> will be set to <code>"arg_1"</code> below only when the fallback is evaluated. Then, the chain will be walked and the final value of <code>arg_1</code> will be determined.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">some_fun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">arg_1</span> <span class="op">=</span> <span class="fu"><a href="reference/fallback.html">fallback</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">arg_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/resolve_fallback.html">resolve_fallback</a></span><span class="op">(</span><span class="va">arg_1</span><span class="op">)</span>
  <span class="va">arg_1</span><span class="op">$</span><span class="va">value</span>
<span class="op">}</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>fallback.verbose <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># make chain walk explicit</span>

<span class="fu">some_fun</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; resolving argument arg_1 </span>
<span class="co">#&gt; ● trying ./fallbacks.yaml: ✖ failed (source file does not exist)</span>
<span class="co">#&gt; ● trying ~/fallbacks.yaml: ✖ failed (source file does not exist)</span>
<span class="co">#&gt; ● resorting to terminal fallback value: ✔ success (TRUE ... )</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="fu">some_fun</span><span class="op">(</span><span class="st">"q"</span><span class="op">)</span>
<span class="co">#&gt; resolving argument arg_1 </span>
<span class="co">#&gt; ● resorting to literal input value:  ✔ success (q)</span>
<span class="co">#&gt; [1] "q"</span>

<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>fallback.verbose <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># less verbose</span>

<span class="fu">some_fun</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; resolving argument arg_1 (terminal fallback)</span>
<span class="co">#&gt; [1] TRUE</span>

<span class="fu">some_fun</span><span class="op">(</span><span class="st">"q"</span><span class="op">)</span>
<span class="co">#&gt; resolving argument arg_1 (literal input value)</span>
<span class="co">#&gt; [1] "q"</span></code></pre></div>
<p>You can disable message printing completely with <code>options(fallback.verbose = 0)</code>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of fallback from GitHub:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"lorenzwalthert/fallback"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="applications">Applications<a class="anchor" aria-label="anchor" href="#applications"></a>
</h2>
<p>This is primarily for package developers and functions that are called in interactive use. One use case could be the source code formatter <a href="https://styler.r-lib.org" class="external-link">styler</a>, where one want to define a configuration on a project by project basis. We could create the following config file in a project root:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>strict<span class="op">:</span><span class="st"> </span>False</span>
<span id="cb5-2"><a href="#cb5-2"></a>scope<span class="op">:</span><span class="st"> </span>spaces</span></code></pre></div>
<p>Note that we can place R code in the YAML file like <code>!expr seq(1, 2)</code>.</p>
<p>If the declaration of <code>tidyverse_style</code> was</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tidyverse_style</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">scope</span> <span class="op">=</span> <span class="fu"><a href="reference/fallback.html">fallback</a></span><span class="op">(</span><span class="st">"tokens"</span><span class="op">)</span>,
                            <span class="va">strict</span> <span class="op">=</span> <span class="fu"><a href="reference/fallback.html">fallback</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span>,
                            <span class="va">indent_by</span> <span class="op">=</span> <span class="fu"><a href="reference/fallback.html">fallback</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span>,
                            <span class="va">start_comments_with_one_space</span> <span class="op">=</span> <span class="fu"><a href="reference/fallback.html">fallback</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span>,
                            <span class="va">reindention</span> <span class="op">=</span> <span class="fu"><a href="reference/fallback.html">fallback</a></span><span class="op">(</span><span class="fu">tidyverse_reindention</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>,
                            <span class="va">math_token_spacing</span> <span class="op">=</span> <span class="fu"><a href="reference/fallback.html">fallback</a></span><span class="op">(</span><span class="fu">tidyverse_math_token_spacing</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">strict</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/resolve_fallback.html">resolve_fallback</a></span><span class="op">(</span><span class="va">strict</span><span class="op">)</span>
  <span class="co"># ...</span>
<span class="op">}</span></code></pre></div>
<p>We could just call</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">style_file</span><span class="op">(</span><span class="st">"R/testing.R"</span>, style <span class="op">=</span> <span class="va">tidyverse_style</span><span class="op">)</span></code></pre></div>
<p>To use the default values from the config file or even omit <code>style</code> because <code>tidyverse_style</code> is the default. We could also place the config file in the home directory so it can be accessed for every project and only declare the deviation from the <em>global</em> style in the project root.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/lorenzwalthert/fallback/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/lorenzwalthert/fallback/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fallback</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Lorent Walthert <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="lifecycle"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lorent Walthert.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
